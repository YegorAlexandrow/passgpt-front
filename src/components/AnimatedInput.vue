<template>
  <q-input
    v-model="newMessageText"
    rounded
    outlined
    type="text"
    placeholder="Ваше сообщение..."
    input-style="padding-left: 12px; padding-bottom: 12px;"
  >
  </q-input>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue';

const prompts = [
  // Развлечения и досуг (48, 29% отказов)
  { emoji: '🎬', text: 'Посоветуй фильм на вечер' },
  { emoji: '🎵', text: 'Подбери музыку для отдыха' },
  { emoji: '📚', text: 'Что почитать интересного?' },
  { emoji: '🎭', text: 'Какие спектакли сейчас идут?' },
  { emoji: '🎮', text: 'Рекомендуй новую игру' },

  // Бизнес (29, 20% отказов)
  { emoji: '💡', text: 'Предложи идею для стартапа' },
  { emoji: '📈', text: 'Как увеличить продажи?' },
  { emoji: '📝', text: 'Придумай название компании' },
  { emoji: '📝', text: 'Придумай название компании' },
  { emoji: '📊', text: 'Сделай анализ рынка' },

  // Финансы (20, 30% отказов)
  { emoji: '💰', text: 'Как начать инвестировать?' },
  { emoji: '💸', text: 'Как сократить расходы?' },
  { emoji: '🏦', text: 'Объясни ипотечные ставки' },
  { emoji: '💳', text: 'Как выбрать кредитную карту?' },
  { emoji: '📉', text: 'Стоит ли покупать акции сейчас?' },

  // Недвижимость (18, 28% отказов)
  { emoji: '🏠', text: 'Как выгодно купить жилье?' },
  { emoji: '🔑', text: 'Советы по аренде квартиры' },
  { emoji: '🏡', text: 'Стоит ли продавать дом сейчас?' },
  { emoji: '📐', text: 'Идеи для планировки' },
  { emoji: '🌇', text: 'Где лучше жить в городе?' },

  // Работа (17, 17% отказов)
  { emoji: '💼', text: 'Как найти работу мечты?' },
  { emoji: '📝', text: 'Помоги написать резюме' },
  { emoji: '🗣️', text: 'Как успешно пройти собеседование?' },
  { emoji: '📈', text: 'Как просить повышения?' },
  { emoji: '👥', text: 'Как наладить отношения в коллективе?' },

  // Транспорт (авто) (15, 13% отказов)
  { emoji: '🚗', text: 'Помоги выбрать автомобиль' },
  { emoji: '🔧', text: 'Как сэкономить на ремонте авто?' },
  { emoji: '⛽', text: 'Как снизить расход топлива?' },
  { emoji: '🛣️', text: 'Лучшие маршруты для поездок' },
  { emoji: '🚘', text: 'Советы по уходу за машиной' },

  // Строительство, ремонт (14, 20% отказов)
  { emoji: '🛠️', text: 'Как сделать ремонт самому?' },
  { emoji: '🪑', text: 'Идеи для выбора мебели' },
  { emoji: '🎨', text: 'Как обновить интерьер?' },
  { emoji: '🏗️', text: 'Советы по строительству дома' },
  { emoji: '🌿', text: 'Добавь зелени в дом' },

  // Отдых и путешествия (12, 0% отказов)
  { emoji: '✈️', text: 'Составь план путешествия' },
  { emoji: '🏖️', text: 'Где отдохнуть на море?' },
  { emoji: '🏨', text: 'Подбери отель по бюджету' },
  { emoji: '🗺️', text: 'Необычные места для отдыха' },
  { emoji: '🚂', text: 'Путешествия по России' },
];

const newMessageText = ref('');
const targetText = ref(prompts[0].text);

function getRandomPrompts(count = 3) {
  const shuffled = prompts.sort(() => 0.5 - Math.random());
  return shuffled.slice(0, count);
}

onMounted(() => {
  let index = 0;
  let phase = 1;
  const caret = '⬤';

  function typeText() {
    if (index >= targetText.value.length + 10) {
      phase = -1;
    }

    if (index <= 1) {
      targetText.value = getRandomPrompts(1)[0].text;
      phase = 1;
    }

    newMessageText.value = targetText.value.substring(0, index + phase) + caret;
    index += phase;
    setTimeout(typeText, 42);
  }
  typeText();
});
</script>
<style>
.msg-btn {
  transition: ease-in-out 0.2s;
}

.msg-btn:hover {
  transform: rotate(-90deg);
}
</style>
